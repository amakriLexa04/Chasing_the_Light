#textdomain wesnoth-ctl

[scenario]
    id=07_Scarhane
	#po: Скархейн
    name= _ "Scarhane"
    map_data="{~add-ons/Chasing_the_Light/maps/07_Scarhane.map}"
	{DEFAULT_SCHEDULE}
	
	{MODIFICATION_COLORSHIFT_MIDLANDS 1}
	{MODIFICATION_COLORSHIFT_BLACKMORE 2}
	{MODIFICATION_COLORSHIFT_WOODLANDOR 9}
	
	{MODIFICATION_COLORSHIFT_MIDLANDS_CURSED 3}
	{MODIFICATION_COLORSHIFT_BLACKMORE_CURSED 4}
	{MODIFICATION_COLORSHIFT_WOODLANDOR_CURSED 5}
	
	{TURNS -1 -1 -1}
	carryover_percentage=40

    victory_when_enemies_defeated=no
	dissalow_recall=no
	#next_scenario=08_Misjudged
	
	{CTL_GI_TRACK {JOURNEY_07} }
	
	##scenery
	{PLACE_IMAGE "items/gravestone1.png~FL(horiz)" 38 21}
	{PLACE_IMAGE (items/gravestone1.png) 32 22}
	{PLACE_IMAGE (items/gravestone1.png) 35 21}
	{PLACE_IMAGE "items/gravestone1.png" 34 22}
	
	{PLACE_IMAGE "items/gravestone2.png" 35 20}
	{PLACE_IMAGE "items/gravestone2.png" 34 23}
	{PLACE_IMAGE "items/gravestone2.png" 35 22}
	{PLACE_IMAGE "items/gravestone2.png~FL(horiz)" 36 22}
	{PLACE_IMAGE "items/gravestone2.png~FL(horiz)" 37 21}
	
	{PLACE_IMAGE "items/gravestone3.png~FL(horiz)" 36 20}
	{PLACE_IMAGE "items/gravestone3.png" 33 21}
	{PLACE_IMAGE "items/gravestone3.png" 33 23}
	
	{PLACE_IMAGE "items/flower2.png~FL(horiz)" 33 21}
	{PLACE_IMAGE "items/flower1.png~FL(horiz)" 35 22}
	{PLACE_IMAGE "items/flower1.png" 38 21}
	{PLACE_IMAGE "items/flower4.png" 36 20}
	
	{PLACE_IMAGE (scenery/signpost.png) 20 56}
	{PLACE_IMAGE (scenery/signpost.png) 49 57}
	{PLACE_IMAGE (scenery/signpost.png) 27 35}
	{PLACE_IMAGE (scenery/signpost.png) 7 6}
	
	#{PLACE_IMAGE (scenery/well.png) 27 14}
	#{PLACE_IMAGE (scenery/leanto.png) 20 16}
	#{PLACE_IMAGE "scenery/leanto.png~FL(horiz)" 25 17}
	#{PLACE_IMAGE (scenery/tent-shop-weapons.png) 24 17}
	
	{PLACE_IMAGE "scenery/mine-abandoned.png~FL(horiz)" 16 56}
	
	##sides
    [side]
        side=1
        id,defeat_condition=haralin,never
        {GOLD 350 300 250}
        {INCOME 10 5 2}
        controller=human
        team_name=Islefolk
        {FLAG_VARIANT long}
        user_team_name=_"Haralin's Squad"
    [/side]
	
	[side]
        side=2
		color=red
		id=blackmore_king
        name=_ "Count Edvar" 
		x,y=23,17
        unrenamable=yes	
        type=Royal Warrior
		controller=ai
        team_name=Islefolk
		{FLAG_VARIANT long}
		{GOLD -670 -895 -1356}
        {INCOME -10 -14 -20}
        user_team_name=_ "Defenders of Scarhane"
		[ai]
			grouping="defensive"
        [/ai]
    [/side]

    [side]
        side=3
		color=blue
		controller=ai
		id=faisim
        type=Shadow Lord
		name= _ "Faisim" ##Файсім
		unrenamable=yes
		profile="portraits/wesfolk/faisim.png"
		gender=female
		x,y=26,2
        canrecruit=yes
        team_name=Wesfolk
        user_team_name=_ "Lenvan's Forces"
        {FLAG_VARIANT undead}
		{GOLD 200 250 300}
        {INCOME 0 2 4}
		[ai]
            aggression=0.8
			simple_targeting=yes
			allow_ally_villages=yes
        [/ai]
    [/side]
	{STARTING_VILLAGES_ALL 3}
	{STARTING_VILLAGES_AREA 1 16 55 1}
	{STARTING_VILLAGES_AREA 2 26 15 10}
	{STARTING_VILLAGES_AREA 2 15 14 1}
	{STARTING_VILLAGES_AREA 2 18 22 1}
	{STARTING_VILLAGES_AREA 2 42 21 1}
	
	##for better first objective control
	[side]
        side=4
		color=blue
		controller=ai
		id=s7_necromancer
        type=Dark Sorcerer
		x,y=22,53
        canrecruit=yes
        team_name=Wesfolk
        user_team_name=_ "Wesfolk Necromancers"
        {FLAG_VARIANT ragged}
		{GOLD 50 75 100}
        {INCOME -10 -5 0}
		[ai]
		    aggression=1.0
			simple_targeting=yes
			allow_ally_villages=yes
        [/ai]
    [/side]
	
	[side]
        side=5
		color=blue
		controller=ai
		id=s7_death_knight
        type=Death Knight
		x,y=24,37
        canrecruit=yes
        team_name=Wesfolk
        user_team_name=_ "Wesfolk Army"
        {FLAG_VARIANT ragged}
		{GOLD 300 350 400}
        {INCOME 0 2 4}
		[ai]
            aggression=1.0
			simple_targeting=yes
			allow_ally_villages=yes
        [/ai]
    [/side]
	
	[side]
        side=6
		color=blue
		controller=ai
		id=s7_bone_knight
        type=Bone Knight
		x,y=61,58
        canrecruit=yes
        team_name=Wesfolk
        user_team_name=_ "Knights of Woodlandor"
        {FLAG_VARIANT ragged}
		{GOLD 75 100 150}
        {INCOME 0 0 0}
		[ai]
			allow_ally_villages=yes
        [/ai]
    [/side]
	
	[side]
        side=7
		color=blue
		controller=ai
		id=s7_ghast
        type=Ghast
		x,y=58,16
        canrecruit=yes
        team_name=Wesfolk
        user_team_name=_ "Inky Moor Ghouls"
        {FLAG_VARIANT ragged}
		{GOLD 100 125 150}
        {INCOME 0 2 4}
		[ai]
            aggression=1.0
			simple_targeting=yes
			allow_ally_villages=yes
        [/ai]
    [/side]
	
	[side]
        side=8
		color=green
		controller=ai
		hidden=yes
		no_leader=yes
        team_name=Elementals
        user_team_name=_ "Elementals"
        {FLAG_VARIANT ragged}
    [/side]
	
	# Statue
    [side]
        side,controller,color=9,null,black
        team_name=Islefolk,Wesfolk,Elementals
        no_leader,hidden=yes,yes
    [/side]

    ##prestart
    [event]
        name=prestart
		
		{RECALL_XY haralin 18 56}
		{RECALL_XY daeola 18 56}
		{RECALL_XY asa 18 56}
		{RECALL_XY peasant_hater 18 56}
		{RECALL_XY wose 18 56}
		{RECALL_XY hunter 18 56}
		
		#scarhane units 
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman"} 15  10 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman"} 17  20 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman"} 30  13 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman"} 30  16 ()}
		#{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman"} 26  19 ()}
		#{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman"} 21  20 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman"} 42  19 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman	"} 27  27 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman	"} 31  27 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Spearman" "Spearman" "Spearman"} 22  23 ()}
		
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Poacher" "Poacher" "Poacher"} 34  17 ()}
		
        {GENERIC_UNITC 2 {ON_DIFFICULTY "Swordsman" "Swordsman" "Swordsman"} 25  9 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Swordsman" "Swordsman" "Swordsman"} 19  19 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Swordsman" "Swordsman" "Swordsman"} 26  11 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Swordsman" "Swordsman" "Swordsman"} 19  16 ()}
		
        {GENERIC_UNITC 2 {ON_DIFFICULTY "Fencer" "Fencer" "Fencer"} 24  10 ()}
		
        {GENERIC_UNITC 2 {ON_DIFFICULTY "Bowman" "Bowman" "Bowman"} 23  12 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Bowman" "Bowman" "Bowman"} 26  26 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Bowman" "Bowman" "Bowman"} 19  17 ()}
		
        {GENERIC_UNITC 2 {ON_DIFFICULTY "Pikeman" "Pikeman" "Pikeman"} 22  13 ()}
        {GENERIC_UNITC 2 {ON_DIFFICULTY "Pikeman" "Pikeman" "Pikeman"} 29  25 ()}
		
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Lieutenant" "Lieutenant" "Lieutenant"} 20  11 ()}
        {GENERIC_UNITC 2 {ON_DIFFICULTY "Lieutenant" "Lieutenant" "Lieutenant"} 42  18 ()}		
		
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Longbowman" "Longbowman" "Longbowman"	} 18  11 ()}
	    
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Javelineer" "Javelineer" "Javelineer	"} 15  14 ()}
	    
		#{GENERIC_UNITC 2 {ON_DIFFICULTY "Peasant" "Peasant" "Peasant"} 22  15 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Peasant" "Peasant" "Peasant"} 43  12 ()}
		{GENERIC_UNITC 2 Swordsman 32  26 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Peasant" "Peasant" "Peasant"} 38  17 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Peasant" "Peasant" "Peasant"} 33  13 ()}
	    #{GENERIC_UNITC 2 {ON_DIFFICULTY "Peasant" "Peasant" "Peasant"} 28  14 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Peasant" "Peasant" "Peasant"} 28  16 ()}
		
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Woodsman" "Woodsman" "Woodsman"} 28  11 ()}
	    #{GENERIC_UNITC 2 {ON_DIFFICULTY "Woodsman" "Woodsman" "Woodsman"} 17  16 ()}
	    #{GENERIC_UNITC 2 {ON_DIFFICULTY "Woodsman" "Woodsman" "Woodsman"} 24  18 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Woodsman" "Woodsman" "Woodsman"} 26  13 ()}
		
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Sergeant" "Sergeant" "Sergeant"} 42  11 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Sergeant" "Sergeant" "Sergeant"} 26  9 ()}
		
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Ruffian" "Ruffian" "Ruffian"} 18  9 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Ruffian" "Ruffian" "Ruffian"} 21  18 ()}
	    
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Heavy Infantryman" "Heavy Infantryman" "Heavy Infantryman"} 17 16 ()}
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Heavy Infantryman" "Heavy Infantryman" "Heavy Infantryman"} 20  22 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Shock Trooper" "Shock Trooper" "Heavy Infantryman"} 42  21 ()}
	    {GENERIC_UNITC 2 {ON_DIFFICULTY "Shock Trooper" "Shock Trooper" "Heavy Infantryman"} 33  11 ()}
	    
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Shock Trooper" "Shock Trooper" "Shock Trooper"} 29  10 ()}
	    
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Halberdier" "Halberdier" "Halberdier"} 36  13 ()}
	    
		{GENERIC_UNITC 2 {ON_DIFFICULTY "Duelist" "Duelist" "Duelist"} 44 18 ()}
	    
		{LOYAL_UNIT 2 {ON_DIFFICULTY "Royal Guard" "Royal Guard" "Royal Guard"} 22  16}
	    {LOYAL_UNIT 2 {ON_DIFFICULTY "Royal Guard" "Royal Guard" "Royal Guard"} 23  18}
	    
	    {LOYAL_UNIT 2 Caravan 27  17}
	    {LOYAL_UNIT 2 Caravan 25  15}
	    {LOYAL_UNIT 2 Caravan 27  14}
		
		[modify_unit]
		[filter]
		type=Heavy Infantryman,Shock Trooper,Iron Mauler,Royal Warrior
		[/filter]
		
		[movement_costs]
		mountains=2
		[/movement_costs]
		[defense]
		mountains=60
		[/defense]
		[/modify_unit]
		
		[modify_unit]
		[filter]
		type=Caravan
		[/filter]
		{IS_HERO}
		[/modify_unit]
		
		##undead
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 28  5} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 22  5} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 9  13} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 12 15} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 12 18} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 19 25} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 25 42} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 27 40} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Draug" "Draug" "Draug"} 29 41} {GUARDIAN}
		
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Revenant" "Revenant" "Draug"} 27 5} {GUARDIAN}
		{LOYAL_UNIT 5 {ON_DIFFICULTY "Revenant" "Revenant" "Draug"} 8 12} {GUARDIAN}
		
		[modify_unit]
		[filter]
		side=5
		[not]
		id=s7_death_knight
		[/not]
		[/filter]
		max_moves=0
		moves=0
		[/modify_unit]
		
		##wesfolk attacking
		#undead
		{GENERIC_UNITC 3 {ON_DIFFICULTY "Skeleton" "Skeleton" "Deathblade"} 13 12 ()}
		{GENERIC_UNITC 3 {ON_DIFFICULTY "Skeleton" "Skeleton" "Deathblade"} 26 27 ()}
		{GENERIC_UNITC 3 {ON_DIFFICULTY "Skeleton" "Skeleton" "Revenant"} 41 11 ()}
		{GENERIC_UNITC 3 {ON_DIFFICULTY "Skeleton" "Revenant" "Revenant"} 16 27 ()}
		{GENERIC_UNITC 3 {ON_DIFFICULTY "Skeleton" "Revenant" "Draug"} 16 16 ()}
		{GENERIC_UNITC 3 Skeleton 45 20 ()}
		{GENERIC_UNITC 3 Skeleton 46 22 ()}
		{GENERIC_UNITC 3 Skeleton 39 24 ()}
		{GENERIC_UNITC 3 Skeleton 20 31 ()}
		{GENERIC_UNITC 3 Deathblade 34 11 ()}
		
		{GENERIC_UNITC 3 {ON_DIFFICULTY "Skeleton Archer" "Skeleton Archer" "Bone Shooter"} 15 19 ()}
		{GENERIC_UNITC 3 "Skeleton Archer" 12 7 ()}
		{GENERIC_UNITC 3 "Bone Shooter" 23 11 ()}
		{GENERIC_UNITC 3 Banebow 20 23 ()}
		
		{GENERIC_UNITC 3 "Death Squire" 45 19 ()}
		
		{GENERIC_UNITC 3 Revenant 14 9 ()}
		
		{GENERIC_UNITC 4 Soulless 8 33 ()}
		{GENERIC_UNITC 4 Soulless 19 36 ()}
		{GENERIC_UNITC 4 Soulless 17 33 ()}
		{GENERIC_UNITC 4 Soulless 11 28 ()}
		{GENERIC_UNITC 4 Soulless 34 34 ()}
		{GENERIC_UNITC 4 Soulless 38 27 ()}
		{GENERIC_UNITC 4 Soulless 43 22 ()}
		{GENERIC_UNITC 4 Soulless 43 13 ()}
		{GENERIC_UNITC 4 Soulless 37 10 ()}
					   
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 11 31 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 18 28 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 35 4 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Walking Corpse"} 40 6 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 38 8 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Walking Corpse"} 42 9 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 48 16 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 49 21 ()}
		{GENERIC_UNITC 4 "Walking Corpse" 42 25 ()}
		{GENERIC_UNITC 4 "Walking Corpse" 52 5 ()}
		{GENERIC_UNITC 4 "Walking Corpse" 47 36 ()}
		{GENERIC_UNITC 4 "Walking Corpse" 57 22 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 47 26 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 43 28 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 45 31 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 50 28 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Walking Corpse"} 40 38 ()}
		{GENERIC_UNITC 4 {ON_DIFFICULTY "Walking Corpse" "Walking Corpse" "Soulless"} 14 37 ()}
		
		{GENERIC_UNITC 6 {ON_DIFFICULTY "Skeleton Rider" "Bone Knight" "Bone Knight"} 52 57 ()}
		{GENERIC_UNITC 6 "Skeleton Rider" 43 58 ()}
		{GENERIC_UNITC 6 "Skeleton Rider" 35 54 ()}
		{GENERIC_UNITC 6 "Skeleton Rider" 26 49 ()}
		{GENERIC_UNITC 6 "Skeleton Rider" 25 32 ()}
		{GENERIC_UNITC 6 "Skeleton Rider" 49 57 ()}
		{GENERIC_UNITC 6 "Bone Knight" 30 31 ()}
		#{GENERIC_UNITC 6 {ON_DIFFICULTY "Skeleton Rider" "Skeleton Rider" "Bone Knight"} 31 35 ()}
		
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghost" "Ghost" "Shadow"} 6 4 ()}
		{GENERIC_UNITC 7 Ghost 4 8 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghost" "Ghost" "Shadow"} 8 16 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghost" "Ghost" "Ghost"} 3 20 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Shadow" "Shadow" "Shadow"} 5 25 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghost" "Ghost" "Ghost"} 13 25 ()}
					   
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Necrophage"} 39 3 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Necrophage"} 34 9 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Ghoul"} 45 3 ()}
		#{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Necrophage"} 47 7 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Ghoul"} 55 8 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Ghoul"} 51 14 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Ghoul"} 52 19 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Ghoul"} 60 17 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Necrophage"} 51 26 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Ghoul"} 59 29 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Ghoul"} 57 40 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Ghoul" "Ghoul" "Necrophage"} 47 39 ()}
					   
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Necrophage" "Necrophage" "Ghast"} 55 4 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Necrophage" "Necrophage" "Necrophage"} 49 10 ()}
		##{GENERIC_UNITC 7 {ON_DIFFICULTY "Necrophage" "Necrophage" "Ghast"} 54 11 ()}
		##{GENERIC_UNITC 7 {ON_DIFFICULTY "Necrophage" "Necrophage" "Necrophage"} 58 9 ()}
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Necrophage" "Necrophage" "Necrophage"} 54 30 ()}
					   
		{GENERIC_UNITC 7 {ON_DIFFICULTY "Necrophage" "Ghast" "Ghast"} 21 10 ()}
		
		#humans
		{GENERIC_UNITC 3 Rogue 16 6 ()}
		{GENERIC_UNITC 3 bandit_axe 20 7 ()}
		{GENERIC_UNITC 3 bandit_axe 23 30 ()}
		{GENERIC_UNITC 3 bandit_net 32 28 ()}
		{GENERIC_UNITC 3 Trapper 25 7 ()}
		{GENERIC_UNITC 3 {ON_DIFFICULTY "Thug" "Bandit" "Highwayman"} 30 6 ()}
		{GENERIC_UNITC 3 {ON_DIFFICULTY "Bandit" "Bandit" "Bandit"} 39 30 ()}
		
		##leaders
		[unit]
	        id=s7_shadow_mage
            type=Shadow Mage
		    side=3
		    x,y=24,3
            [modifications]
            {TRAIT_LOYAL}
        [/modifications]
	    [/unit]
		
		[set_extra_recruit]
            id=faisim
            extra_recruit=Poacher, Trapper, Rogue Mage, Arcane Enforcer, Footpad, Thief, bandit,bandit_net
        [/set_extra_recruit]
		
		[unit]
	        id=Familiar
            type=Familiar
		    side=3
		    x,y=3,14
            canrecruit=yes
	    [/unit]
		
		[set_extra_recruit]
            id=Familiar
            extra_recruit=Skeleton, Skeleton Archer, Vampire Bat, Blood Bat, {ON_DIFFICULTY "Blood Bat" "Blood Bat" "Dread Bat"}
        [/set_extra_recruit]

		[set_extra_recruit]
            id=s7_ghast
            extra_recruit=Walking Corpse, Soulless, Ghoul, Necrophage
        [/set_extra_recruit]
		
		[unit]
	        id=s7_necrophage
            type=Necrophage
		    side=7
		    x,y=50,35
            canrecruit=yes
	    [/unit]
		
		[set_extra_recruit]
            id=s7_necrophage
            extra_recruit=Walking Corpse, Soulless, Ghoul, {ON_DIFFICULTY "Ghoul" "Ghoul" "Necrophage"}
        [/set_extra_recruit]
		
		[unit]
	        id=s7_spectre
            type=Spectre
		    side=3
		    x,y=2,36
            canrecruit=yes
	    [/unit]
		
		[set_extra_recruit]
            id=s7_spectre
            extra_recruit=Ghost, Wraith, Shadow
        [/set_extra_recruit]
		
		[set_extra_recruit]
            id=s7_death_knight
            extra_recruit=Skeleton, Skeleton Archer, Revenant, Deathblade, Death Squire, Bone Shooter, {ON_DIFFICULTY "Revenant" "Draug" "Draug"}, {ON_DIFFICULTY "Bone Shooter" "Banebow" "Banebow"}
        [/set_extra_recruit]
		
		[unit]
	        id=s7_highwayman
            type=Highwayman
		    side=5
		    x,y=29,47
            canrecruit=yes
	    [/unit]
		
		[set_extra_recruit]
            id=s7_highwayman
            extra_recruit=Thug, Ruffian, Poacher, Bandit, Trapper, Footpad, Outlaw, bandit, bandit_axe, bandit_scythe
        [/set_extra_recruit]
		
		[set_extra_recruit]
            id=s7_necromancer
            extra_recruit=Skeleton, Skeleton Archer, Dark Adept
        [/set_extra_recruit]
		
        [set_extra_recruit]
            id=s7_bone_knight
            extra_recruit= Skeleton Rider, {ON_DIFFICULTY "Skeleton Rider" "Skeleton Rider" "Bone Knight"}
        [/set_extra_recruit]
		
		[micro_ai]
            side=2,3,4,5,6,7
            ai_type=fast_ai
            action=add
        [/micro_ai]
		
		[modify_unit]
		[filter]
		x=25,27,8
		y=42,40,12
		[/filter]
		facing=se
		[/modify_unit]
		
		[modify_unit]
		[filter]
		x=22,27,28,29
		y=5,5,5,41
		[/filter]
		facing=sw
		[/modify_unit]
		
		[modify_unit]
		[filter]
		x=9,12,12,19
		y=13,15,18,25
		[/filter]
		facing=ne
		[/modify_unit]
		
		##statue
		{GENERIC_UNITC 9 Statue 26 15 ()}
		
		
		##передача керування. Thanks to Mirion
		[set_variable]
            name=control_me
            value=ai
        [/set_variable]

        #right click option to make side=2 ai or human controller
        [set_menu_item]
        id=human_controller
        description="Take over control of Count Edvar's forces"
        [show_if]
            [variable]
            name=control_me
            equals=ai
            [/variable]
        [/show_if]
        [command]
            [set_variable]
            name=control_me
            value=human
            [/set_variable]
            [message]
	         	speaker,image=narrator,wesnoth-icon.png
	         	message= _ "Тепер військами Графа Едвара керуєте ви. Ви отримаєте контроль над ними як тільки завершите свій хід."
		    [/message]
            [modify_side]
            side=2
            controller=$control_me
            [/modify_side]
        [/command]
        [/set_menu_item]

        [set_menu_item]
        id=ai_controller
        description="Turn over control of Count Edvar's forces"
        [show_if]
            [variable]
            name=control_me
            equals=human
            [/variable]
        [/show_if]
        [command]
            [set_variable]
            name=control_me
            value=ai
            [/set_variable]
            [message]
	         	speaker,image=narrator,wesnoth-icon.png
	         	message= _ "Тепер військами Графа Едвара керує штучний інтелект. Будьте обережні, він може робити дивні дії!"
		    [/message]
            [modify_side]
            side=2
            controller=$control_me
            [/modify_side]
        [/command]
        [/set_menu_item]
	
	
	    {VARIABLE graves_notes 0}	
		
		##for enemy Polymorph
		[set_variables]
            name=polymorph_transformation

            [value]
                human_type=Shadow Mage
                animal_type=Cave Bear
            [/value]
            [value]
                human_type=Shadow Lord
                animal_type=Orcish Warlord
            [/value]
        [/set_variables]
	
    [/event]

    ##start 
	[event]
        name=start
		
		##{SPEAK faisim _"PORTRAIT TEST"}
		
		
		
	##вмикаємо магію
        {CLEAR_VARIABLE no_spellcasting_event_daeola}
        {CLEAR_VARIABLE no_spellcasting_event_haralin}
		
		{VARIABLE unlock_ward_d yes}
		{VARIABLE skill_ward_d yes}
		{FIRE_EVENT refresh_daeola_skills}
		
		{VARIABLE unlock_bend yes}
		{VARIABLE unlock_bend_earth yes}
		{VARIABLE unlock_bend_water yes}
		{VARIABLE unlock_bend_lava yes}
		{VARIABLE unlock_bend_air yes}
		{VARIABLE skill_bend yes}
		{FIRE_EVENT refresh_haralin_skills}

        ##вибір заклять. відключено на час розробки
        {RESELECT_SKILLS_AFTER_OBJECTIVES haralin () ()}
        {RESELECT_SKILLS_AFTER_OBJECTIVES daeola () ()}
	[/event]
	
	##gravestones moveto
	{GRAVES_LABELS 33 23 ({CAPTION ( _ "Королівський посланець — близько 20 років")} + _"<i>З далекої Південної Бухти привіз до обложеної твердині Скархейн вісті від Короля Аддрорана IV. Невдовзі помер від отриманих в дорозі поранень.
	
Спи спокійно, воїне, ти впорався з Королівським завданням.</i>") items/gravestone1.png}
	{GRAVES_LABELS 32 22 ({CAPTION ( _ "Юддмила — 83 роки")} + _"<i>Тут лежить мати двох дітей та пращурка кількох поколінь. Кінець життя її був сповнений страждань, проте хай зараз вона спочиває.
	
Мені шкода, прабабусю, що безліч років не мала змоги бачити тебе. Власними руками воздвигаю цей пам'ятний камінь в надії, що пробачиш мені.</i>") items/gravestone3.png}
	##питання до Гараліна що то могла бути за істота
	{GRAVES_LABELS 34 23 ({CAPTION ( _ "Велетню зі Зл..аних .ір — вік не......й")} + _"<i>Іс..тою б.в не.юдс.кою, п..те . .е ..ірячою. І ... дур..й був т. лед.ч.й, в ча.. потр.би до... ... посл...в сво.. с.лою.</i>") items/gravestone2.png}
	{GRAVES_LABELS 34 22 (_"<i>(Ця могила настільки давня, що на ній не збереглося жодної цілої літери).</i>") items/gravestone1.png}
	##додати комент від юніта, що могили дуже древні
	{GRAVES_LABELS 33 21 ({CAPTION ( _ "Аш..ара — 16 ..к.в")} + _"<i>Хо...ра .ої..лька та влучний стр..ець, про.. се н. ...регло її ..д меча в..л....рця, .ай б.де ... пр....тий</i>") items/gravestone3.png}
	##мертва дружина графа
	{GRAVES_LABELS 35 22 ({CAPTION ( _ "Графиня Аввиль — 31 рік")} + _"<i>Вічним сном навіки спить тут опора та любов моя, Аввиль Чорнотопська.
	
Мною, Графом Чорнотопу та Другим сином Короля Аддрорана III, клятву дано, що не спочину, поки не переможемо в війні проти твоїх вбивць.</i>") items/gravestone2.png}
	{GRAVES_LABELS 36 22 ({CAPTION ( _ "Аленсель Божевільний — більше 60 років")} + _"<i>Тут покоїться безхатько, що веселив усе місто байками про свої неймовірні пригоди та подвиги.</i>") "items/gravestone2.png~FL(horiz)"}
	{GRAVES_LABELS 35 21 ({CAPTION ( _ "Купець Хиван — 42 роки")} + _"Благочестивий чоловік, був забитий на смерть жадібними волоцюгами. Їх повісили наступного ранку.") items/gravestone1.png}
	{GRAVES_LABELS 36 20 ({CAPTION ( _ "Брати з Високого Пагорбу")} + _"<i>Під цією плитої поховані мої сини, що загинули від закляття західняцького чаклуна. Хай славиться Граф Едвар за те, що зміг врятувати їхні тіла!
	
Ось ймена їхні, щоб не було забуто воїнів:
• Унер — 23 роки
• Маеддос — 23 роки
• Енис — 21 рік
• Лелін — 17 років</i>") items/gravestone2.png}
	##додати комент від юніта, що могили дуже древні
	{GRAVES_LABELS 35 20 ({CAPTION ( _ "Об..онцю Ска..е.ну (<i>сколото</i>)")} + _"<i>З...яки самоп.жертві твоїй, війська в.личного К...ля Нашого, Ґворва.. .Х., змогли ....... до твердині .кар...ну та про.......ти ... там.
	
Подвиг й... ..тиме с...д нас, . х.. нік..и не буд. забуто сь..о добле...го воїна.</i>") "items/gravestone3.png~FL(horiz)"}
	{GRAVES_LABELS 37 21 ({CAPTION ( _ "Веснотаб Аланс — 16 років")} + _"<i>Хоч яким неідеальним він був, гірко за ним сумуватимуть.</i>") "items/gravestone2.png~FL(horiz)"}
	{GRAVES_LABELS 38 21 ({CAPTION ( _ "Амакарі Скірван — 25 років")} + _"<i>Солдат гарнізону, загинув у бою з бандитами на північній заставі. Його дружина та троє дітей пам'ятатимуть його до кінця днів.</i>") "items/gravestone1.png~FL(horiz)"}
	
	
	
    {SIGNPOSTS_LABELS (1,2) 20 56 _"Громадські копальні Скархейну.
Будь-хто з обома руками матиме можливість заробити тут собі на хліб." ()}	
    {SIGNPOSTS_LABELS (1,2) 27 35 _"Будь-яким ворогам Чорнотопу буде дано рішучу відсіч, як ти з таких — повертай негайно заради ж свого блага." ()}
	{SIGNPOSTS_LABELS (1,2) 7 6 _"Схід сонця приведе до воріт славетного Скархейну, захід вже вкаже до поселень поблизу витоку Старотічної ріки." ()}
	{SIGNPOSTS_LABELS (1,2) 49 57 _"Далі по цій дорозі лежать землі Вудлендору. Будь-який люд Чорнотопу, що перейде цю межу, вважатиметься загарбниками та ворогами." ()}
	
	##прибрати меню керування ботами в разі перемоги
	[event]
	name=victory
	
	[clear_menu_item]
	id=human_controller,ai_controller
	[/clear_menu_item]
	
	[/event]
	
	##комент про те, що Ленван підіймає мерців та те, що це чогось не діє на магів
	[event]
	    name=s7_rise_dead
		first_time_only=yes
		
		[if]
		[have_unit]
		id=blackmore_king
		[/have_unit]
		[and]
		[have_unit]
		id=asa
		[/have_unit]
		[/and]
		[and]
		[have_unit]
		id=daeola
		[/have_unit]
		[/and]
		[then]
		{DELAY 700}
		
		##{SPEAK haralin _"Тест"}
		[/then][/if]
		
    [/event]
	
	##піднімати мерців після смерті
	[event]
        name=die
        first_time_only=no
        [filter]
            race=human
			[not]
			    type=Dark Sorcerer,Necromancer,Dark Adept,Shadow Mage, Rogue Mage, Shadow Lord, {MAGES_ONLY}
			[/not]
        [/filter]
        [filter_second]
            [not]
                type=Walking Corpse,Soulless, {MAGES_ONLY}
            [/not]
        [/filter_second]

    [unit]
        type=Walking Corpse
        side=3
        x=$x1
        y=$y1
        placement=map
        overwrite=yes
        moves=0
        attacks_left=0
        variation=$unit.undead_variation
        animate=yes
		upkeep=loyal
    [/unit]
	
	{FIRE_EVENT s7_rise_dead}

    [/event]
	
	##gold reinforcements(не давати wesfolk army та wesfolk Necromancers золота, бо вони в центрі мапи)
	[event]
	name,first_time_only=side 3 turn refresh,no
	
        {FILTER_CONDITION(
                  {VARIABLE_CONDITIONAL turn_number equals 11}
            {OR(  {VARIABLE_CONDITIONAL turn_number equals 15}  )}
            {OR(  {VARIABLE_CONDITIONAL turn_number equals 22}  )}
            {OR(  {VARIABLE_CONDITIONAL turn_number greater_than_equal_to 26}  )}
        )}

        [modify_side]
		side=3
		gold= {ON_DIFFICULTY 100 150 200}
		[/modify_side]
		
		[modify_side]
		side=6
		gold= {ON_DIFFICULTY 75 100 125}
		[/modify_side]
		
		 [modify_side]
		side=7
		gold= {ON_DIFFICULTY 125 150 175}
		[/modify_side]
		
		[sound]
            name=horn-signals/horn-8.ogg
        [/sound]
		
	[/event]
	
	##horn gold reinforcements
	[event]
	name=side 3 turn 11
	
	{DELAY 600}
	
	{SPEAK blackmore_king _"Певно, проклятий тисячу разів ворог отримав чергові підкріплення, раз чуємо ми тяжкий поклик сурми... Однак не страшіться, воїни — хай що стане зі Скархейном, нас їм ніколи не подолати!"}

	[/event]
	
	##wesfolk book event, child event and then daeola teleport(teleport only for now)
	[event]
	name=die
	[filter]
	id=s7_necromancer
	[/filter]
	
	[set_variable]
        name=book_3_x
        value= $unit.x
    [/set_variable]
	
	[set_variable]
        name=book_3_y
        value= $unit.y
    [/set_variable]
	
	{PLACE_IMAGE (items/book5.png) $book_3_x $book_3_y}
	
	##коментар від того, хто вбив некроманта, про книгу + реакція Гараліна
	
	{MOVE_UNIT id=haralin $book_3_x $book_3_y}
	
	##коментар Гараліна про те, що від цієї книги віє темрявою чи подібна маячня. Далі він спалює книгу
	
	{DELAY 700}
	[animate_unit]
        flag=attack
        [filter]
            id=haralin
        [/filter]
		[primary_attack]
		range=ranged
		[/primary_attack]
		[facing]
		x,y=$book_3_x,$book_3_y
		[/facing]
    [/animate_unit]
	
	[remove_item]
        x,y=$book_3_x,$book_3_y
        image="items/book5.png"
    [/remove_item]
	
	[sound]
            name=wose-die.ogg
        [/sound]
	
	{CLEAR_VARIABLE book_3_x}
	{CLEAR_VARIABLE book_3_y}
	
	## після цього він звертає увагу на хлопця в таборі
	
	##додати ефекти
	
	{DELAY 600}
	
	[teleport]
	[filter]
	id=daeola
	[/filter]
	x,y=26,22
	animate=yes
	[/teleport]
	
	{GENERIC_UNITC 1 apprentice 26 21 ()}
	{GENERIC_UNITC 1 apprentice 25 23 ()}
	{GENERIC_UNITC 1 apprentice 27 23 ()}
	
	[modify_unit]
	[filter]
	x=26,26,25,27
	y=22,21,23,23
	[/filter]
	moves=0
	attacks_left=0
	[/modify_unit]
	
	[/event]
	
	#смерть Файсім у образі орка, через фаєр івент приліпити катсцену з її смертю
	[event]
	name=last breath
	[filter]
	id=faisim
	type=Orcish Warlord
	[/filter]
	
	    {SOUND skill-polymorph.wav}
        {ANIMATE_UNIT (id=faisim) levelout}
	    
        [store_unit]
            [filter]
                id=faisim
            [/filter]
	    
            kill=yes
            variable=s7_sl_strd_back
        [/store_unit]
	    
	    [redraw]
        [/redraw]
        
        [unit]
            type=Shadow Lord
            side=3
	    	gender=$s7_sl_strd_back.gender
            x,y=$s7_sl_strd_back.x,$s7_sl_strd_back.y
            id=$s7_sl_strd_back.id
            name=$s7_sl_strd_back.name
	    	hitpoints=0
            experience=$s7_sl_strd_back.experience
            canrecruit=$s7_sl_strd_back.canrecruit
            [modifications]
                [insert_tag]
                    name=trait
                    variable=$s7_sl_strd.modifications.trait
                [/insert_tag]
            [/modifications]
        [/unit]
		
		[kill]
		id=faisim
		animate=yes
		fire_event=yes
		[/kill]

	[/event]
	
	#смерть чаклуна з поліморфом у образі тварини
	[event]
	name=last breath
	[filter]
	id=s7_shadow_mage
	type=Cave Bear
	[/filter]
	
	    {SOUND skill-polymorph.wav}
        {ANIMATE_UNIT (id=s7_shadow_mage) levelout}
	    
        [store_unit]
            [filter]
                id=s7_shadow_mage
            [/filter]
	    
            kill=yes
            variable=s7_sm_strd_back
        [/store_unit]
	    
	    [redraw]
        [/redraw]
        
        [unit]
            type=Shadow Mage
            side=3
	    	gender=$s7_sm_strd_back.gender
            x,y=$s7_sm_strd_back.x,$s7_sm_strd_back.y
            id=$s7_sm_strd_back.id
            name=$s7_sm_strd_back.name
	    	hitpoints=0
            experience=$s7_sm_strd_back.experience
            canrecruit=$s7_sm_strd_back.canrecruit
            [modifications]
                [insert_tag]
                    name=trait
                    variable=$s7_sm_strd.modifications.trait
                [/insert_tag]
            [/modifications]
        [/unit]
		
		[kill]
		id=s7_shadow_mage
		animate=yes
		fire_event=yes
		[/kill]

	[/event]
	
	#book_polymorph common
	[event]
	name=die
	[filter]
	id=s7_shadow_mage
	[/filter]
	
	[set_variable]
        name=book_5_x
        value= $unit.x
    [/set_variable]
	
	[set_variable]
        name=book_5_y
        value= $unit.y
    [/set_variable]
	
	{PLACE_IMAGE (items/book5.png) $book_5_x $book_5_y}
	
	[/event]
	
	#define POLYMORPH_BOOK_COMMON
    [message]
		        speaker,image=narrator,wesnoth-icon.png
		        message= _ "Наступного сценарію Гаралін знатиме ще одне додаткове закляття — Polymorph."
		    [/message]
		
		    [set_variable]
                name="Haralin_learn_Polymorph"
                value= _ "true"
		    [/set_variable]
		
		    [remove_item]
                x,y=$book_5_x,$book_5_y
                image="items/book5.png"
            [/remove_item]
		
		    {CLEAR_VARIABLE book_5_x}
		    {CLEAR_VARIABLE book_5_y}
		
		    {VARIABLE_OP book add 1}
		    [progress_achievement]
                content_for=Chasing_the_Light
                id="ctl_book"
                amount=1
                limit=$book
            [/progress_achievement]
#enddef


    ##pick up book. переписати в зручніший макрос
	[event]
	name=moveto
	first_time_only=no
		
		[filter]
		    side=1,2
		    x=$book_5_x
		    y=$book_5_y
		[/filter]
		
		[if]
		[variable]
		    name=unit.id 
		    equals=daeola
		[/variable]
        [then]

            #коментар  Даеоли		
		
		    {POLYMORPH_BOOK_COMMON}
		
		[/then]
		[elseif]
		[variable]
		    name=unit.id 
		    equals=haralin
		[/variable]
		[then]
		##коментар від самого Гараліна, цей варіант практично неможливий
		
		{POLYMORPH_BOOK_COMMON}
		[/then]
		[/elseif]
		[elseif]
		[variable]
		    name=unit.side
		    equals=1
		[/variable]
		[and]
		[variable]
		    name=unit.id 
		    equals=daeola
		[/variable]
		[/and]
		[then]
		##коментар від магів, вони теж забирають книги
		
		{POLYMORPH_BOOK_COMMON}
		[/then]
		[/elseif]
		[else]
		##вигадати інший коментар від сторони 2
		    ##[message]
		    ##    speaker=unit
		    ##    message= _ "Я навіть читати не вмію, нащо воно мені треба?"
		    ##[/message]
			
		[/else][/if]
		
		[/event]
	
	##book_polymorph with orc spell. Додати перед цим івент при смерті Файсім через last breath
	[event]
	name=die
	[filter]
	id=faisim
	[/filter]
	
	[set_variable]
        name=book_4_x
        value= $unit.x
    [/set_variable]
	
	[set_variable]
        name=book_4_y
        value= $unit.y
    [/set_variable]
	
	{PLACE_IMAGE (items/book5.png) $book_4_x $book_4_y}
	
	[/event]
	
	#define POLYMORPH_BOOK_ELITE
    [message]
		        speaker,image=narrator,wesnoth-icon.png
		        message= _ "Наступного сценарію Гаралін знатиме ще одне додаткове закляття — Polymorph, включаючи унікальну техніку перетворення на невідому броньовану істоту."
		    [/message]
		
		    [set_variable]
                name="Haralin_learn_Polymorph_Elite"
                value= _ "true"
		    [/set_variable]
		
		    [remove_item]
                x,y=$book_4_x,$book_4_y
                image="items/book5.png"
            [/remove_item]
		
		    {CLEAR_VARIABLE book_4_x}
		    {CLEAR_VARIABLE book_4_y}
		
		    {VARIABLE_OP book add 1}
		    [progress_achievement]
                content_for=Chasing_the_Light
                id="ctl_book"
                amount=1
                limit=$book
            [/progress_achievement]
#enddef
	
	##pick up book. переписати в зручніший макрос
	[event]
	name=moveto
	first_time_only=no
		
		[filter]
		    side=1,2
		    x=$book_4_x
		    y=$book_4_y
		[/filter]
		
		[if]
		[variable]
		    name=unit.id 
		    equals=daeola
		[/variable]
        [then]

            #коментар  Даеоли		
		
		    {POLYMORPH_BOOK_ELITE}
		
		[/then]
		[elseif]
		[variable]
		    name=unit.id 
		    equals=haralin
		[/variable]
		[then]
		##коментар від самого Гараліна, цей варіант практично неможливий
		
		{POLYMORPH_BOOK_ELITE}
		[/then]
		[/elseif]
		[elseif]
		[variable]
		    name=unit.side
		    equals=1
		[/variable]
		[and]
		[variable]
		    name=unit.id 
		    equals=daeola
		[/variable]
		[/and]
		[then]
		##коментар від магів, вони теж забирають книги
		
		{POLYMORPH_BOOK_ELITE}
		[/then]
		[/elseif]
		[else]
		##вигадати інший коментар від сторони 2
		    ##[message]
		    ##    speaker=unit
		    ##    message= _ "Я навіть читати не вмію, нащо воно мені треба?"
		    ##[/message]
			
		[/else][/if]
		
		[/event]
		
	##поліморф вночі
    [event]
        name=side 8 turn refresh
        first_time_only=no

        {VARIABLE temp $turn_number}
        {VARIABLE_OP temp modulo 6}

        [if]
            [variable]
                name=temp
                equals=4
            [/variable]

            [then]
                

                [redraw]
                [/redraw]
				
				[if]
				[have_unit]
				id=faisim
				[/have_unit]
				[then]
				
				[scroll_to_unit]
				id=faisim
				[/scroll_to_unit]
				
                {SOUND skill-polymorph.wav}
                {ANIMATE_UNIT (id=faisim) levelout}
            

                [store_unit]
                    [filter]
                        id=faisim
                    [/filter]

                    kill=yes
                    variable=s7_sl_strd
                [/store_unit]
				
				[unit]
                    type=Orcish Warlord
                    side=3
					gender=$s7_sl_strd.gender
                    x,y=$s7_sl_strd.x,$s7_sl_strd.y
                    id=$s7_sl_strd.id
                    name=$s7_sl_strd.name
					unrenamable=yes
                    experience=$s7_sl_strd.experience
                    canrecruit=$s7_sl_strd.canrecruit
                [/unit]
				
				[set_extra_recruit]
            id=faisim
            extra_recruit=Poacher, Trapper, Rogue Mage, Arcane Enforcer, Footpad, Thief, bandit,bandit_net
        [/set_extra_recruit]
				
				[redraw]
                [/redraw]
				
				[/then][/if]
				
				[if]
				[have_unit]
				id=s7_shadow_mage
				[/have_unit]
				[then]
				
				[scroll_to_unit]
				id=s7_shadow_mage
				[/scroll_to_unit]
				
				{DELAY 700}
				
				{SOUND skill-polymorph.wav}
				{ANIMATE_UNIT (id=s7_shadow_mage) levelout}
            

                [store_unit]
                    [filter]
                        id=s7_shadow_mage
                    [/filter]

                    kill=yes
                    variable=s7_sm_strd
                [/store_unit]
				
				[unit]
                    type=Cave Bear
                    side=3
					gender=$s7_sm_strd.gender
                    x,y=$s7_sm_strd.x,$s7_sm_strd.y
                    id=$s7_sm_strd.id
                    name=$s7_sm_strd.name
                    experience=$s7_sm_strd.experience
                    canrecruit=$s7_sm_strd.canrecruit
					[modifications]
            {TRAIT_LOYAL}
        [/modifications]
                [/unit]
				
				[redraw]
                [/redraw]
				
				[/then][/if]
           
            [/then]
        [/if]
    [/event]

    [event]
        name=side 8 turn refresh
        first_time_only=no

        {VARIABLE temp $turn_number}
        {VARIABLE_OP temp modulo 6}

        [if]
            [variable]
                name=temp
                equals=1
            [/variable]

            [variable]
                name=turn_number
                greater_than_equal_to=4
            [/variable]

            [then]

                [redraw]
                [/redraw]
				
				[if]
				[have_unit]
				id=faisim
				[/have_unit]
				[then]
				
				[scroll_to_unit]
				id=faisim
				[/scroll_to_unit]
				
				{SOUND skill-polymorph.wav}
                {ANIMATE_UNIT (id=faisim) levelout}

                [store_unit]
                    [filter]
                        id=faisim
                    [/filter]

                    kill=yes
                    variable=s7_sl_strd_back
                [/store_unit]
				
				[redraw]
                [/redraw]
                
                [unit]
                    type=Shadow Lord
                    side=3
					gender=$s7_sl_strd_back.gender
                    x,y=$s7_sl_strd_back.x,$s7_sl_strd_back.y
                    id=$s7_sl_strd_back.id
                    name=$s7_sl_strd_back.name
					unrenamable=yes
					hitpoints=$s7_sl_strd.hitpoints
                    experience=$s7_sl_strd_back.experience
                    canrecruit=$s7_sl_strd_back.canrecruit
                    [modifications]
                        [insert_tag]
                            name=trait
                            variable=$s7_sl_strd.modifications.trait
                        [/insert_tag]
                    [/modifications]
                [/unit]
				
				[set_extra_recruit]
            id=faisim
            extra_recruit=Poacher, Trapper, Rogue Mage, Arcane Enforcer, Footpad, Thief, bandit,bandit_net
        [/set_extra_recruit]
				
				[/then][/if]
				
				[if]
				[have_unit]
				id=s7_shadow_mage
				[/have_unit]
				[then]
				
				[scroll_to_unit]
				id=s7_shadow_mage
				[/scroll_to_unit]
				
				{DELAY 700}
				
				{SOUND skill-polymorph.wav}
				{ANIMATE_UNIT (id=s7_shadow_mage) levelout}
				
				[store_unit]
                    [filter]
                        id=s7_shadow_mage
                    [/filter]

                    kill=yes
                    variable=s7_sm_strd_back
                [/store_unit]
				
				[redraw]
                [/redraw]
                
                [unit]
                    type=Shadow Mage
                    side=3
					gender=$s7_sm_strd_back.gender
                    x,y=$s7_sm_strd_back.x,$s7_sm_strd_back.y
                    id=$s7_sm_strd_back.id
                    name=$s7_sm_strd_back.name
					hitpoints=$s7_sm_strd.hitpoints
                    experience=$s7_sm_strd_back.experience
                    canrecruit=$s7_sm_strd_back.canrecruit
                    [modifications]
                        [insert_tag]
                            name=trait
                            variable=s7_sm_strd.modifications.trait
                        [/insert_tag]
                    [/modifications]
					[modifications]
            {TRAIT_LOYAL}
        [/modifications]
                [/unit]
				
			[/then][/if]

                       
            [/then]
        [/if]
    [/event]
	
	##flying skull escape macro
	#define S7_SKULL_ESCAPE
	
	{SPEAK Familiar _"*клац-клац!*"}
	
	[cancel_action][/cancel_action]
	
	{MOVE_UNIT id=Familiar 1 17}
	
    [kill]
    id=Familiar
    [/kill]	
	
	{SPEAK faisim {WHISPER _"quietly^<i>так, тікай до свого жалюгідного владики, боягузлива істото; у тебе був шанс нарешті померти, проте знову ти його втратив...</i>"}}
	
	[set_achievement]
        content_for=Chasing_the_Light
        id="ctl_skull_escape"
    [/set_achievement]
	
	#enddef
	
	##flying skull fly away before attack
	[event]
	name=attack
	first_time_only=no
	[filter_second]
	id=Familiar
	[/filter_second]
	
	{S7_SKULL_ESCAPE}
	
	[/event]
	
	##flying skull fly away if injured
	[event]
	name=side 3 turn refresh
	first_time_only=no
	
	[store_unit]
        [filter]
            id=Familiar
        [/filter]
        variable=s7_check_familiar
    [/store_unit]
	
	[if]
	[variable]
	name=s7_check_familiar.hitpoints
	not_equals=$s7_check_familiar.max_hitpoints
	[/variable]
	[and]
	[have_unit]
	id=Familiar
	[/have_unit]
	[/and]
	[then]
	
	{S7_SKULL_ESCAPE}
	
	[/then][/if]
	[/event]
	
	##utils for mountains moves for heavy
	[event]
    name=post advance
    first_time_only=no
	[filter]
		type=Heavy Infantryman,Shock Trooper,Iron Mauler,Royal Warrior
    [/filter]
	
    [modify_unit]
        {FILTER id=$unit.id}
        [movement_costs]
		    mountains=2
		[/movement_costs]
		[defense]
		    mountains=60
		[/defense]
    [/modify_unit]
	
	[/event]
	
	##time over. додати чийсь коментар(після захоплення табору чаклуна ліміт прибрати і повернути тоді, коли треба буде продержатися N кількість ходів як Гаралін почне кастувати на двері)
	##у першому випадку це буде поразка, у другому перемога
	[event]
	name= time over
	
	[/event]
	
	##втрата каравану
	[event]
	name=die
	[filter]
	type=Caravan
	[/filter]
	
	##коментар від Графа
	
	[endlevel] 
        result=defeat
    [/endlevel]
	
	[/event]
	
	##смерть Графа
	[event]
	name=last breath
	[filter]
	id=blackmore_king
	[/filter]
	
	##коментар від Графа
	
	[/event]
	
	##смерть Графа, коментар Гараліна чи Аси, програш
	[event]
	name=die
	[filter]
	id=blackmore_king
	[/filter]
	
	##коментар від Гараліна чи Аси
	
	[endlevel] 
        result=defeat
    [/endlevel]
	
	[/event]
	
	{HERODEATH_DAEOLA}
	{HERODEATH_HARALIN}
	{HERODEATH_HATER}
	{HERODEATH_HUNTER}
	{HERODEATH_ASA}
	{HERODEATH_WOSE}
[/scenario]